<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin Login | TheOpenLawLab</title>
    <meta name="description" content="Admin access portal for TheOpenLawLab." />
    <meta property="og:title" content="Admin Login | TheOpenLawLab" />
    <meta property="og:description" content="Admin access portal for TheOpenLawLab." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://theopenlawlab.org/admin/login/" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Admin Login | TheOpenLawLab" />
    <meta name="twitter:description" content="Admin access portal for TheOpenLawLab." />
    <link rel="canonical" href="https://theopenlawlab.org/admin/login/" />
    <link rel="stylesheet" href="/assets/styles.css" />
  </head>
  <body>
    <a class="skip-link" href="#main">Skip to content</a>
    <header class="site-header">
      <div class="shell nav-wrap">
        <a class="brand" href="/"><img class="brand-icon" src="/assets/brand-icon.svg" alt="" /><span>TheOpenLawLab</span></a>
        <nav aria-label="Primary">
          <ul class="nav-list">
            <li><a href="/projects/">Projects</a></li>
            <li><a href="/about/">About</a></li>
            <li><a href="/contribute/">Contribute</a></li>
          </ul>
        </nav>
      </div>
    </header>
    <main id="main" class="shell"><section class="admin-shell">
        <h1>Admin Access</h1>
        <p>Enter the admin password to continue.</p>
        <form id="admin-login-form" class="admin-form" novalidate>
          <label for="admin-password">Admin password</label>
          <input id="admin-password" name="password" type="password" required autocomplete="current-password" />
          <label class="admin-honeypot" for="admin-bot-trap">
            <input id="admin-bot-trap" name="botTrap" type="checkbox" />
            Don’t check this box - to prevent bots
          </label>
          <button class="btn" type="submit">Continue</button>
          <p id="admin-login-message" class="admin-message" role="status" aria-live="polite"></p>
        </form>
      </section>
      <script type="module">
        const form = document.querySelector('#admin-login-form');
        const message = document.querySelector('#admin-login-message');

        const setMessage = (text) => {
          if (message) message.textContent = text;
        };

        form?.addEventListener('submit', async (event) => {
          event.preventDefault();
          const formData = new FormData(form);
          const payload = {
            password: String(formData.get('password') || ''),
            botTrap: formData.get('botTrap') === 'on'
          };

          setMessage('Checking credentials...');

          try {
            const response = await fetch('/.netlify/functions/admin-auth', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload)
            });

            const data = await response.json();

            if (!response.ok || !data.authorized) {
              setMessage('Access denied.');
              return;
            }

            sessionStorage.setItem('adminAuthorized', 'true');
            window.location.assign('/admin/');
          } catch (error) {
            setMessage('Unable to verify credentials right now.');
          }
        });
      </script></main>

    <div class="dialog-root" data-dialog-root hidden>
      <div class="dialog-overlay" data-dialog-overlay></div>
      <section
        class="dialog-content"
        data-dialog-content
        role="dialog"
        aria-modal="true"
        aria-labelledby="dialog-title"
        aria-describedby="dialog-description"
        tabindex="-1"
      >
        <button class="dialog-close" type="button" data-dialog-close aria-label="Close dialog">
          ×
        </button>
        <div class="dialog-header">
          <h2 id="dialog-title">Welcome to TheOpenLawLab</h2>
          <p id="dialog-description">We just launched. Thanks for visiting — more projects, tools, and resources are coming soon.</p>
        </div>
      </section>
    </div>

    <footer class="sticky-footer" aria-label="Site footer" data-sticky-footer>
      <div class="sticky-footer-clip">
        <div class="sticky-footer-track">
          <div class="shell sticky-footer-shell sticky-footer-panel" data-footer-panel>
            <div class="sticky-footer-grid" data-footer-item>
          <section class="footer-nav-section" data-footer-item style="--footer-item-delay:0s">
              <h2>About</h2>
              <ul>
                <li><a href="/">Home</a></li><li><a href="/projects/">Projects</a></li><li><a href="/about/">Our Mission</a></li><li><a href="/contact/">Contact Us</a></li><li><a href="/admin/login/">Admin</a></li>
              </ul>
            </section>
            </div>
            <div class="sticky-footer-bottom" data-footer-item style="--footer-item-delay:0.32s">
              <div>
            <p class="sticky-footer-title">The <span class="sticky-footer-title-icon" aria-hidden="true"><img class="brand-icon" src="/assets/footer-o-icon.svg" alt="" /></span><span class="sr-only">O</span>pen Law Lab</p>
            <p class="sticky-footer-subtitle">Open-source legal infrastructure for everyone</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <script type="module" src="/assets/modal.js"></script>
    <script type="module" src="/assets/footer-motion.js"></script>
  </body>
</html>